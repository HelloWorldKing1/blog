# 论微服务架构及应用

【摘要】

2021年3月，我所在某大型家装公司参与研发了一套《新零售商城》，我司由于业务扩展，希望新开一家家装门店以新零售的商业模式进行运营，并打造一款支持WEB、小程序的在线商城以支持。该系统主要分为  会员、商品、购物车、订单、支付、运营等模块。在本系统中，我担任系统架构师一职，负责架构设计和技术选型工作。本文以该系统并结合自身实践论述了微服务在项目中的应用。前端web采用Vue3.0加TypeScript，通过Nginx负载均衡与服务器集群结合，解决前台界面的并发问题，后台应用采用Springcloud微服务框架搭建，将系统拆成多个微服务，通过Nacos进行服务注册、服务发现和配置管理，Gateway做API网关，进行路由转发和权限校验，Feign进行服务间的远程调用，RocketMq做中间件消息处理，ElasticSearch做搜索引擎，Redis进行缓存等；最终系统顺利上线，受到用户和商家的一致好评。

【正文】

​     我在一个 家装公司任职，本公司是本市的家装行业龙头企业，业务主要涵盖了装修设计，智能家居，大型建材自营商城。 本项目是 公司新开了一家门店，希望以新零售的商业模式运营，并打造一款支持WEB、小程序的在线商城以支持。新零售是指能将线上和线下进行融合，消费者可以从线上进行选物，然后在线下门店进行实际体验，另外还可以通过大数据来了解消费者的消费习惯。

  本系统主要分为用户端（Web页面、小程序）、供应商后台、运营后台三个大的服务。用户端可以进行注册登陆、查看商品、加购、下单、支付、退款退货和评论打分。供应商后台由在平台注册的家装供应商管理分类、管理品牌、发布商品、审核商品、审核退款等，运营后台可以管理文章、管理评价、意见反馈、直播管理、促销管理等。在这个项目中，我担任了系统架构师的职务主要负责系统的架构设计相关工作。

  我们经过讨论分析，决定使用微服务架构来开发新零售系统项目。在单体架构设计中，所有的功能模块都属于一个庞大的系统，各模块之间耦合度过高，无法进行分布式部署，单个功能也很难在水平方向上灵活的按需扩展，与单体架构设计相比，微服务的优势在于：

1、应用根据业务水平拆分为多个服务，各司其职

2、服务之间 轻量级的通信机制。在不同的服务之间进行数据交换可以使用不同技术栈，互不影响

3、微服务架构方式是松耦合的，可以提供扩展的灵活性

4、每个微服务可以交给不同团队独立开发，互不影响，加快项目上线速度

5、独立部署，某个服务中需要修改代码。可以只部署此修改了的服务，大大降低了部署的风险和影响

新零售的微服务架构基于SpringCloud框架，系统平台划分为前端Web服务、平台保障服务、业务服务

1.前端Web服务

用户端是提供给用户使用的界面，本系统分别设计了WEB端（供电脑用户使用）和小程序端（供手机用户使用），当用户访问系统时，首先会访问到Nginx负载均衡服务器，负载均衡服务器会将请求转发到后台GateWay网关鉴权，然后根据路由规则、断言和过滤器 访问到后台指定的接口。

